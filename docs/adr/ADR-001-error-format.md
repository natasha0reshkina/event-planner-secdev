# ADR-001: Формат ошибок и идентификатор запроса
Дата: 2025-10-20
Статус: Accepted

## Context
Пользователь должен получать понятные и единообразные ответы об ошибках, а сервис — не раскрывать лишние детали. Сейчас сообщения разнородны, часть текстов может содержать технические подробности. Нужен единый формат, чтобы связать ошибки с журналом и тестами.

## Decision
Используется формат RFC 7807 для всех ответов об ошибках. Поля: type, title, status, detail, correlation_id. Личные данные в detail не выводятся. Для каждого запроса создаётся correlation_id, который записывается в журнал.

Проверка:
все конечные точки выдают формат RFC 7807,
в каждом ответе есть correlation_id,
контрактные и сквозные тесты подтверждают формат.

## Consequences
Единообразие ответов, удобная трассировка по correlation_id, отсутствие утечек технических деталей. Потребуется обновить слой обработки ошибок и тесты.

## Links
NFR-02 Формат ошибок и скрытие личных данных
tests/test_errors.py::test_problem_details_contract
