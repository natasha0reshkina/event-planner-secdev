# ADR-003: Ограничение частых ошибок входа
Дата: 2025-10-21

## Context
Многократные неудачные попытки входа повышают риск подбора паролей. Нужен простой лимит по числу неуспешных входов за окно времени.

## Decision
Окно десять минут на один адрес.
Пять неуспешных попыток приводят к блокировке на пятнадцать минут.
Счетчик и время окончания блокировки хранятся в памяти приложения или базе.
Пользователю возвращается понятное сообщение о временной блокировке.

Проверка:
не более пяти неудачных входов за десять минут,
следующая попытка в окне возвращает отказ с пояснением,
интеграционный тест подтверждает блокировку.

## Alternatives
Капча.
Отсутствие ограничений.
Лимит по адресу с блокировкой.

## Consequences
Плюсы: снижает риск подбора, просто внедрить.
Минусы: возможны ложные блокировки при общем адресе, нужна очистка старых записей.

## Security impact
Снижается риск атак перебора паролей.
Появляется возможность быстрее выявлять злоупотребления и фиксировать их в журнале.

## Rollout plan
Реализовать счетчик неудачных входов по адресу.
Включить блокировку на пятнадцать минут после порога.
Добавить тест tests/test_login_limit.py::test_blocks_after_five_failures.
Проверить разблокировку по таймеру.

## Links
NFR-09 Ограничение частых ошибок входа
tests/test_login_limit.py::test_blocks_after_five_failures
